<section class="wrapper work-panel">
    <app-header></app-header>
    <app-sidebar></app-sidebar>
    <div class="work-block">
        <div class="team-part-1" *ngIf="!showCreate">
              <div class="create-team">
                 <div class="container">
                    <div class="row">
                       <div class="col-12">
                          <div class="hdg-box">
                             <h1 class="hdg-main">Create a team is just a step away</h1>
                             <p class="sb-hdg">Here are the steps below to create a team.</p>
                          </div>
                       </div>
                    </div>
                    <div class="row">
                       <div class="col-12">
                          <div class="progress-bar__circles">
                             <div class="progress-bar__circle progress-bar__circle--completed" data-toggle="modal" data-target="#exampleModal">
                                <span class="number">1</span>
                                <span class="progress-bar__circle__label">Choose Team Name</span>
                             </div>
                             <div class="progress-bar__bar"></div>
                             <div class="progress-bar__circle" data-toggle="modal" data-target="#MembersModal">
                                <span class="number">2</span>
                                <span class="progress-bar__circle__label">Add Members</span>
                             </div>
                             <div class="progress-bar__bar"></div>
                             <div class="progress-bar__circle progress-bar__circle--selected">
                                <span class="number">3</span>
                                <span class="progress-bar__circle__label">Submit</span>
                             </div>
                          </div>
                       </div>
                       <div class="col-12">
                          <div class="btn-center">
                             <button type="button" class="btn btn-colored" id="create-team-btn" (click)="createTeam()">Create New Team</button>
                          </div>
                       </div>
                    </div>
                 </div>
              </div>
              <div class="team-list">
                 <div class="container dashboard-container">
                    <div class="row">
                       <div class="col-12">
                          <div class="hdg-box">
                             <h1 class="hdg-main">Team list</h1>
                             <p class="sb-hdg">Below are the list of top group near you.</p>
                          </div>
                       </div>
                    </div>
                    <div class="row">
                       <div class="col-12">
                          <div class="table-responsive">
                             <table class="table table-striped table-bordered team-table">
                                <thead>
                                   <tr>
                                      <th>Group Name</th>
                                      <th></th>
                                   </tr>
                                </thead>
                                <tbody>
                                   <tr *ngFor="let team of teamArr; let i = index">
                                      <td>{{team?.name}}</td>
                                      <td>Group Info <i class="far fa-plus-square add-icon" (click)="openUser(team.teamId)"></i></td>
                                   </tr>
                                  
                                </tbody>
                             </table>
                          </div>
                       </div>
                       <div class="col-12">
                          <div class="btn-center">
                             <button type="button" class="btn btn-colored" (click)="getTeam()" *ngIf="moreTeam">Load More Teams</button>
                          </div>
                       </div>
                    </div>
                 </div>
              </div>
              <div class="my-team">
                 <div class="container-fluid dashboard-container1">
                    <div class="row">
                       <div class="col-12">
                          <div class="hdg-box">
                             <h1 class="hdg-main">My Team & Groups</h1>
                             <p class="sb-hdg">Lorem ipsum, or lipsum as it is sometimes known</p>
                          </div>
                       </div>
                    </div>
                    <div class="group-sec">
                       <div class="row">
                          <div class="col-md-3">
                             <div class="group-block" data-toggle="modal" data-target="#group-info">
                                <img src="assets/images/buy2-property.jpeg">
                                <div class="group-hover">
                                   <h6>Share Details</h6>
                                </div>
                             </div>
                          </div>
                          <div class="col-md-3">
                             <div class="group-block" data-toggle="modal" data-target="#group-info">
                                <img src="assets/images/article1.jpeg">
                                <div class="group-hover">
                                   <h6>Room Services</h6>
                                </div>
                             </div>
                          </div>
                          <div class="col-md-3">
                             <div class="group-block" data-toggle="modal" data-target="#group-info">
                                <img src="assets/images/homepage-friends.jpg">
                                <div class="group-hover">
                                   <h6>Room Pleace</h6>
                                </div>
                             </div>
                          </div>
                          <div class="col-md-3">
                             <div class="group-block" data-toggle="modal" data-target="#group-info">
                                <img src="assets/images/buy-property.jpeg">
                                <div class="group-hover">
                                   <h6>Room Contact</h6>
                                </div>
                             </div>
                          </div>
                       </div>
                    </div>
                    <div class="row">
                       <div class="col-12">
                          <div class="btn-center">
                             <button type="button" class="btn btn-colored">View ALL</button>
                          </div>
                       </div>
                    </div>
                 
                 </div>
              </div>
              <div class="col-md-12">
                 <div class="team-member">
                    <div class="custom_member">
                       <!--- Chat HTML START -------->
                       <div class="container">
                          <div class="messaging">
                             <div class="inbox_msg">
                                <div class="inbox_people">
                                   <div class="headind_srch">
                                      <div class="recent_heading">
                                         <h4>Groups</h4>
                                      </div>
                                   </div>
                                   <div class="inbox_chat" >
                                      <div class="chat_list" *ngFor="let team of teamArr; let index = index" [class.active_chat]="index == this.indexCheck">
                                         <div class="chat_people">
                                            <div class="chat_img"> <img src="https://ptetutorials.com/images/user-profile.png" alt="sunil"> </div>
                                            <div class="chat_ib" (click)="openChat(team,index)">
                                               <h5 >
                                                  {{team?.name}} 
                                               </h5>
                                               <p>
                                               </p>
                                            </div>
                                         </div>
                                      </div>
                                   </div>
                                </div>
                                <div class="mesgs">
                                   <div class="msg_history" *ngFor="let message of gruopMessages,index as i">
                                      <div class="incoming_msg" *ngIf="message.from_id != logged_in_id">
                                         <div class="incoming_msg_img">
                                            <img src="https://ptetutorials.com/images/user-profile.png" alt="sunil"> 
                                         </div>
                                         <div class="received_msg" >
                                            <div class="received_withd_msg">
                                               <p> {{ message.message}} </p>
                                               <span class="time_date"> {{message.userName}}</span>
                                               <span class="time_date"> {{message.created_at | date: 'H:mm | MMM dd'}}</span>
                                            </div>
                                         </div>
                                      </div>
                                      <div class="outgoing_msg" *ngIf="message.from_id == logged_in_id">
                                         <div class="sent_msg">
                                            <p> {{ message.message}} </p>
                                            <span class="time_date"> {{message.created_at | date: 'H:mm | MMM dd'}}</span>
                                         </div>
                                      </div>
                                   </div>
                                </div>
                                <div class="type_msg">
                                   <div class="input_msg_write">
                                      <input type="text" class="write_msg" placeholder="Type a message" [(ngModel)]="message" [style.border]="valMessage ? '1px solid red' : ''">
                                      <button class="msg_send_btn add_member_btn" type="button" (click)="sendMessgae()" ngbTooltip="Send Message"> <i class="fa fa-paper-plane-o" aria-hidden="true"></i></button>
                                      <button class="msg_send_btn" type="button" ngbTooltip="Add Member To Group"> <i class="fa fa-user" aria-hidden="true"></i></button>
                                   </div>
                                </div>
                                <div _ngcontent-dsn-c2="" class="headind_srch testing">
                                   <div _ngcontent-dsn-c2="" class="recent_heading">
                                      <h4 _ngcontent-dsn-c2=""> Team </h4>
                                   </div>
                                   <a mat-icon-button [matMenuTriggerFor]="menu" aria-label="Example icon-button with a menu">
                                      <mat-icon>more_vert</mat-icon>
                                   </a>
                                   <mat-menu #menu="matMenu">
                                      <button mat-menu-item (click)="addmember()">
                                         <mat-icon>group_add</mat-icon>
                                         <span>Add Member</span>
                                      </button>
                                      <button mat-menu-item (click)="viewteamCV()">
                                         <mat-icon>group</mat-icon>
                                         <span>View Team CV</span>
                                      </button>
                                   </mat-menu>
                                </div>
                             </div>
                         </div>
                       </div>
                     </div>
                 </div>
              </div>
           
          </div>
        <div class="team-part-2" *ngIf="showCreate">
              <div class="team-creation">
                 <div class="container dashboard-container">
                    <div class="row">
                       <div class="col-12">
                          <div class="hdg-box">
                             <h1 class="hdg-main">team creation</h1>
                             <p class="sb-hdg">Here are the steps below to create a team.</p>
                          </div>
                       </div>
                    </div>
                    <div class="progress-bar__circles">
                       <div class="progress-bar__circle progress-bar__circle--completed" data-toggle="modal" data-target="#exampleModal">
                          <span class="number">1</span>
                          <span class="progress-bar__circle__label">Choose Team Name</span>
                       </div>
                       <div class="progress-bar__bar progress-bar__bar--completed"></div>
                       <div class="progress-bar__circle progress-bar__circle--completed">
                          <span class="number">2</span>
                          <span class="progress-bar__circle__label">Add Members</span>
                       </div>
                       <div class="progress-bar__bar" [ngClass]="{'progress-bar__bar--completed': completed}"></div>
                       <div class="progress-bar__circle" [ngClass]="{'progress-bar__circle--completed': completed}">
                          <span class="number">3</span>
                          <span class="progress-bar__circle__label">Submit</span>
                       </div>
                    </div>
                    <form [formGroup]="createTeamForm" (ngSubmit)="TeamSubmit()">
                        <div class="row" id="team-name" *ngIf="hide">
                        <div class="col-12">
                            <div class="card mb-3">
                                <div class="card-header">Choose your Team Name</div>
                                <div class="card-body">
                                    <div class="row" style="justify-content: center; text-align: center;">
                                    <div class="col-12 col-sm-6">
                                        <div class="form-group">
                                            <label for="name">Enter Your Team Name:</label>
                                            <input type="text" class="form-control" id="name" placeholder="Team Name" formControlName="name">
                                            <div *ngIf="Isrequired" class="teamError-msg">Team name is required</div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-12 text-center">
                                        <button type="button" class="btn btn-colored" id="team-name-button" (click)="back1()">Back</button>
                                        <button type="button" class="btn btn-colored" id="team-name-button" (click)="continue()">Continue</button>
                                    </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>
                        <div class="row" id="team-member" *ngIf="IsContinue">
                        <div class="col-12">
                            <div class="card mb-3">
                                <div class="card-header">Choose Team Member
                                </div>
                                <div class="card-body">
                                    <div class="row" style="justify-content: center;">
                                    <div class="col-12 col-sm-4 size-div" *ngFor="let user of users">
                                        <div class="team-block-top">
                                            <figure>
                                                <img src="http://api.randomuser.me/portraits/men/49.jpg" alt="Scott Stevens" class="rounded-circle" width="45" height="45">
                                            </figure>
                                            <div class="team-name">
                                                <h5 class="size">{{user.firstName}}{{user.lastName}}</h5>
                                            </div>
                                            <div class="admin-btn">
                                                <a (click)="addUser(user.userId)"> {{selectedButton[user.userId] ? 'Remove' : '+ Add'}}
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-12 text-center mt-3">
                                        <button type="button" class="btn btn-colored" (click)="back()">Back</button>
                                        <button type="submit" class="btn btn-colored">Submit</button>
                                    </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>
                    </form>
                 </div>
              </div>
        </div>
    </div>
</section>

<!-- Model for TeamUserInfo -->
<div class="container">
   <!-- The Modal -->
   <div class="modal" id="taskDel" [style.display]="openUserModel ? 'block' : 'none'" *ngIf="openUserModel" >
   <div class="modal-dialog modaldialog12">
      <div class="modal-content">
         <!-- Modal Header -->
         <div class="modal-header">
            <h4 class="modal-title" id="modal-title">Group User Info</h4>
            <button type="button" class="close" aria-describedby="modal-title">
            <span aria-hidden="true" (click)="closeInfoModal()">&times;</span>
            </button>
         </div>
         <!-- Modal body -->
         <div class="modal-body">
         <table class="table">
            <thead>
               <tr>
                     <th></th>
 
                  <th>First Name</th>
                  <th>Last Name</th>
                  <th>Email</th>

               </tr>
            </thead>
              <tbody>
                  <tr *ngFor="let user of teamUser;let i = index ">
                    <td>{{i+1}}</td>
                    <td> {{user.userProfile?.firstName}}   </td>
                    <td>{{user.userProfile?.lastName}}</td>
                    <td>{{user.userProfile?.email}}</td>
                 </tr>
               
              </tbody>
           </table>

         </div>
         <div class="modal-footer">
            <button type="button" class="btn btn-outline-secondary" (click)="closeInfoModal()">Ok</button>
         </div> 
      </div>
   </div>
</div>